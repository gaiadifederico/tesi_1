% Based on the 'bubble' data from Eidors2D, use several 
% different algorithms to image it

% (C) 2005 Andy Adler. License: GPL version 2 or version 3
% $Id: image_2d_algs.m 2003 2009-12-28 17:36:57Z aadler $

n_elec = 8;
n_rings= 1;
 options = {'no_meas_current','no_rotate_meas'};
amplitude=2; %amplitude of stimulation current, default=10mA
[st, ms]= mk_stim_patterns(n_elec, n_rings, '{ad}','{ad}', options, amplitude);
inv2d= mk_common_model('c2c0',n_elec); %576 elementi
inv2d.fwd_model.stimulation = st;
inv2d.fwd_model.meas_select = ms;

f0=[920.87,955.93,852.07,852.07,852.07,920.87,821.68,1000.00,920.87,920.87,920.87,581.02,821.68,852.07,882.84,920.87,920.87,920.87,920.87,920.87,920.87,920.87,821.68,882.84,852.07,920.87,920.87,852.07,852.07,882.84,920.87,920.87,852.07,920.87,882.84,920.87,920.87,821.68,920.87,882.84]';
f1=[951.83,882.84,1000.00,821.68,951.83,920.87,920.87,821.68,821.68,920.87,920.87,602.51,821.68,821.68,920.87,882.84,1000.00,882.84,920.87,920.87,882.84,882.84,920.87,920.87,852.07,852.07,882.84,852.07,882.84,920.87,920.87,821.68,852.07,920.87,821.68,852.07,882.84,955.93,920.87,882.84]';
f2=[852.07,920.87,852.07,882.84,920.87,879.62,882.84,882.84,882.84,920.87,882.84,651.15,674.49,852.07,852.07,882.84,920.87,920.87,920.87,821.68,852.07,882.84,920.87,821.68,882.84,821.68,920.87,882.84,920.87,920.87,1000.00,821.68,920.87,920.87,1000.00,882.84,882.84,920.87,920.87,882.84]';
f3=[920.87,920.87,920.87,920.87,882.84,920.87,882.84,920.87,882.84,920.87,852.07,651.15,882.84,920.87,920.87,882.84,920.87,882.84,852.07,1000.00,852.07,882.84,920.87,920.87,882.84,882.84,852.07,920.87,852.07,821.68,920.87,821.68,920.87,951.83,920.87,821.68,955.93,1000.00,920.87,882.84]';
f4=[821.68,789.64,920.87,821.68,852.07,821.68,843.45,767.39,789.64,789.64,821.68,832.35,821.68,821.68,821.68,821.68,852.07,821.68,882.84,697.31,821.68,821.68,852.07,741.10,767.39,882.84,821.68,821.68,843.45,843.45,791.97,821.68,821.68,920.87,821.68,741.10,821.68,821.68,821.68,821.68]';

img1= inv_solve( inv2d, f0, f1);
img2= inv_solve( inv2d, f0, f2);
img3= inv_solve( inv2d, f0, f3);
img4= inv_solve( inv2d, f0, f4);
%show_fem(img1);
%show_fem(img2);
%show_fem(img3);
show_fem(img4);

